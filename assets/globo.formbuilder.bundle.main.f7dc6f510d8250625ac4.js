(self.webpackChunkgloboFormbuilder=self.webpackChunkgloboFormbuilder||[]).push([[179],{6808:(e,t,n)=>{var o,i;!function(r){if(void 0===(i="function"==typeof(o=r)?o.call(t,n,t,e):o)||(e.exports=i),!0,e.exports=r(),!!0){var a=window.Cookies,l=window.Cookies=r();l.noConflict=function(){return window.Cookies=a,l}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var l="";for(var s in r)r[s]&&(l+="; "+s,!0!==r[s]&&(l+="="+r[s].split(";")[0]));return document.cookie=t+"="+n+l}}function a(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],a=0;a<r.length;a++){var l=r[a].split("="),s=l.slice(1).join("=");n||'"'!==s.charAt(0)||(s=s.slice(1,-1));try{var c=t(l[0]);if(s=(o.read||o)(s,c)||t(s),n)try{s=JSON.parse(s)}catch(e){}if(i[c]=s,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))},8398:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const o=n(6808),i={init:async function(e,t){this.needReRender()&&await this.renderForm(e,t),["mouseover","click","ontouchstart"].forEach((n=>document.addEventListener(n,this.loadCriticalAssets.bind(this,e,t),{once:!0}))),this.handleLabel(e,t),this.handleRequireLogin(t),this.handleLightBox(e,t);const n=this.forms[t].functions??this.specialElements([t]);n.includes("bulkOrder")&&this.handleBulkOrder(e,t),n.includes("cart")&&this.handleCart(e,t),n.includes("wizard")&&this.handleWizard(e,t),n.includes("floatingForm")&&this.handleFloatingForm(e,t),n.includes("hidden")&&this.handleHidden(e,t),n.includes("intl-phone")&&this.handleIntlPhone(e,t),n.includes("datetime")&&this.handleDateTime(e,t),n.includes("conditional")&&this.handleConditional(e,t),n.includes("reCaptcha")&&this.handleReCaptcha(e,t),n.includes("account")&&this.handleAccount(e,t);const o=new CustomEvent("globo.formbuilder.form.loaded",{detail:{form:e,formId:t}});document.dispatchEvent(o)},needReRender:function(){if(document.body.classList.contains("globo-formbuilder-admin-preview"))return!1;let e=!1;const t={};return document.querySelector("#globo-formbuilder-dynamicCSS")&&(t.dynamicCSS=document.querySelector("#globo-formbuilder-dynamicCSS").innerHTML,e=!0),document.querySelector("#globo-formbuilder-template")&&(t.template=document.querySelector("#globo-formbuilder-template").innerHTML,e=!0),document.querySelector("#globo-formbuilder-element")&&(t.element=document.querySelector("#globo-formbuilder-element").innerHTML,e=!0),void 0!==self.utm&&void 0!==self.utm.view&&"formbuilder_edit"==self.utm.view&&(e=!0),this.templates=t,e||this.allFunctions.includes("bulkOrder")||this.forms.some((e=>!e.html))},renderForm:async function(e,t,o=!1){const{default:i}=await Promise.all([n.e(620),n.e(542)]).then(n.bind(n,1331));let r=this.forms[t].elements.filter((e=>e.id.indexOf("products")>-1));if(r.length){await this.handleBulkOrder(e,t);const{bulkOrder:n}=Globo.FormBuilder;await n.updateProducts(r)}const a=this.templates.dynamicCSS||i.templates.dynamicCSS,l=this.templates.template||i.templates.template,s=this.templates.element||i.templates.element;let c=i.parseAndRenderSync(l,{configs:{...this.forms[t],formId:t},partialElement:s,dynamicCSS:a,formId:t,Globo});if(o&&r.length){const{bulkOrder:e}=Globo.FormBuilder;c=e.reShowMessage(c,o)}e.innerHTML=c,e.setAttribute("data-id",t)},loadCriticalAssets:async function(e,t){const o=await Promise.all([n.e(765),n.e(122)]).then(n.bind(n,4104)),{default:i}=o;Object.assign(Globo.FormBuilder,i),e.addEventListener("submit",this.handleSubmit,!1)},handleBulkOrder:async function(e,t){const o=await n.e(649).then(n.bind(n,8419)),{default:i}=o;Object.assign(Globo.FormBuilder,{bulkOrder:i}),i.init(e,t)},handleCart:async function(e,t){if("cart"===this.page?.type){const t=await n.e(511).then(n.bind(n,8857)),{default:o}=t;Object.assign(Globo.FormBuilder,{Cart:o});const i=new o(e);i.setAttributeType(),i.updateCartNote()}},handleWizard:async function(e,t){const o=await n.e(32).then(n.bind(n,906)),{default:i}=o;Object.assign(Globo.FormBuilder,i);const r=e.querySelector(".globo-formbuilder-wizard");new Globo.FormBuilder.Wizard(e,r).init()},handleFloatingForm:async function(e,t){const o=await n.e(995).then(n.bind(n,750)),{default:i}=o;Object.assign(Globo.FormBuilder,i),i.init(e,t)},handleHidden:async function(e,t){const o=await n.e(898).then(n.bind(n,5772)),{default:i}=o;this.hiddenInit=i.init,this.hiddenInit(e,t)},handleIntlPhone:async function(e,t){const o=await n.e(77).then(n.bind(n,6679)),{default:i}=o;i.init(e,t)},handleDateTime:async function(e,t){const o=await Promise.all([n.e(502),n.e(848)]).then(n.bind(n,5293)),{default:i}=o;i.init(e,t)},handleConditional:async function(e,t){const o=await n.e(406).then(n.bind(n,9847)),{default:i}=o;i.init(e,t)},handleReCaptcha:async function(e,t){const o=await n.e(1).then(n.bind(n,8431)),{default:i}=o;Object.assign(Globo.FormBuilder,{reCaptcha:i}),i.init(e)},handleAccount:async function(e,t){const o=await n.e(809).then(n.bind(n,9945)),{default:i}=o;Object.assign(Globo.FormBuilder,{account:i}),i.init(e,t)},handleLabel:function(e,t){const n=e.querySelectorAll(".globo-form-control"),o={};for(let e=0;e<n.length;e++){const t=n[e],i=t.querySelector("label, legend");if(i){const e=t.querySelector("[name]");if(e){const t=e.getAttribute("name").replace("[]",""),n=i.querySelector(".label-content");o[t]=n.dataset.label||n.innerHTML}}}e.querySelector('[name="_keyLabel"]').value=JSON.stringify(o),e.querySelector('[name="page[title]"]').value=this.page?.title,e.querySelector('[name="page[href]"]').value=this.page?.href,this.customer&&(e.querySelector('[name="customer[id]"]')&&(e.querySelector('[name="customer[id]"]').value=this.customer.id),e.querySelector('[name="customer[email]"]')&&(e.querySelector('[name="customer[email]"]').value=this.customer.email),e.querySelector('[name="customer[name]"]')&&(e.querySelector('[name="customer[name]"]').value=this.customer.name))},handleRequireLogin:function(e){const t=this.forms[e].publish;if(!t||!t.requiredLogin)return;if(Globo.FormBuilder.customer?.id)return;const n=document.querySelectorAll(".globo-form-id-"+e);n&&n.forEach((function(e){if(e.querySelector(".globo-form-app")){const n=e.querySelectorAll(".form-container-overlayboxs");if(n&&n.forEach((function(e){e.remove()})),t.requiredLogin){e.classList.add("globo_required_login_form");const n='<div class="form-container-overlayboxs"><div class="form-overlay-box">'+t.requiredLoginMessage+"</div></div>";e.querySelector(".globo-form-app").innerHTML+=n}else e.classList.remove("globo_required_login_form")}}))},handleLightBox:function(e,t){const n=e.closest(".globo-form-publish-modal");if(n&&(e.querySelector(".header.dismiss").classList.remove("hidden"),n.classList.contains("lightbox"))){const e=this.forms[t].publish;switch(e.selectTime){case"none":var i=0;break;case"weeks":i=void 0!==e.setCookieWeeks?7*parseInt(e.setCookieWeeks):7;break;case"days":i=void 0!==e.setCookie?parseInt(e.setCookie):1;break;case"hours":i=void 0!==e.setCookieHours?parseInt(e.setCookieHours)/12:1/12;break;default:i=365}o.get("globo-form-lightbox-"+n.getAttribute("data-id"))!=i&&n.classList.remove("hidden")}}}}}]);